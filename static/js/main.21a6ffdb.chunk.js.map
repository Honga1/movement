{"version":3,"sources":["server/actionsQueue.tsx","server/testData.ts","client/addBots.tsx","client/get-url-parameters.tsx","common/v2.ts","server/PlayerController.tsx","server/WorldController.tsx","server/connectedPlayers.tsx","client/geometry.tsx","client/materials.tsx","client/IdleTarget.tsx","client/Player.tsx","client/TouchTarget.tsx","client/World.tsx","client/App.tsx","index.tsx"],"names":["actionsQueue","generateReplayDatum","offset","nextIndex","replayData","length","type","id","position","count","index","replayGenerator","Math","floor","random","setTimeout","timeStep","timeout","value","next","push","toString","addBots","name","maybeParam","url","window","location","href","replace","results","RegExp","exec","decodeURIComponent","getParameterByName","undefined","parseInt","parseFloat","getUrlParameters","V2O","x","y","atan2","VECTOR_LENGTH","combine","a","b","operation","result","Array","aElement","bElement","fromArray","add","subtract","base","subtraction","multiply","multiplier","scale","factor","map","element","divide","divisor","normalise","vector","euclideanLength","zero","sqrEuclideanLength","sqrEuclideanDistance","distance","euclideanDistanceV2","rotate","angleRadians","cos","sin","flipX","flipY","array","Error","fromVector2","PlayerController","action","playerData","state","transform","rotationDirection","touchPosition","idleTarget","deltaTime","this","updateIdle","updateTouching","rotateAround","rotation","target","directionToTarget","unitToTarget","rotatedUnit","scaledUnit","MAX_CIRCLE_RADIUS","rotatedTarget","directionToCircleTarget","unitToCircleTarget","step","SPEED","from","to","amount","circleAt","PI","unloopedDistance","clamp","removeLoops","lerp","lerpTheta","angle","MIN_CIRCLE_RADIUS","min","max","WorldController","players","actionsThisFrame","forEach","maybePlayer","find","player","nextData","reduceAction","Object","assign","addPlayerWithAction","updateTransform","connectedPlayers","box","BoxBufferGeometry","pink","MeshBasicMaterial","color","blue","green","vw","innerWidth","IdleTarget","data","ref","useRef","useFrame","current","visible","set","material","geometry","Player","context","TouchTarget","World","useState","playerIds","setPlayerIds","update","nextPlayerIds","some","includes","targets","playerIndex","Fragment","playerComponents","canvasCoords","event","clientX","clientY","innerHeight","App","isTouching","className","orthographic","pixelRatio","devicePixelRatio","concurrent","style","width","height","onPointerDown","onPointerMove","onPointerUp","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.21a6ffdb.chunk.js","sourcesContent":["import { PlayerActions } from \"../common/PlayerActions\";\n\nexport const actionsQueue: PlayerActions[] = [];\n","import { PlayerActions } from \"../common/PlayerActions\";\n\nexport function* generateReplayDatum(offset: number) {\n  let nextIndex = offset;\n\n  while (true) {\n    nextIndex++;\n    yield replayData[nextIndex % replayData.length];\n  }\n}\nexport const replayData: PlayerActions[] = [\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-351, 111],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-389, 65],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-391, 55],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-389, 54],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-377, 54],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-373, 53],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-259, 55],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-124, 39],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-61, 32],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-11, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-12, 21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-12, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-13, 21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-15, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-15, 22],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-15, 22],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-15, 22],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-15, 22],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-15, 22],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-17, 22],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-17, 22],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-17, 22],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-17, 22],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-17, 22],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-17, 22],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-17, 22],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-18, 22],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-21, 21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-23, 21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-38, 16],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-39, 15],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-40, 13],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-40, 13],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-41, -4],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-39, -11],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-27, -37],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-18, -39],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-8, -49],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-8, -49],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [5, -54],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [5, -55],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [6, -55],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [10, -55],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-32, -82],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-42, -82],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-109, -95],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-126, -97],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-131, -201],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-90, -283],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [27, -338],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [134, -279],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [134, -261],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [123, -74],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [66, 108],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [57, 119],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-154, 47],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-360, -214],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-22, -234],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-22, -234],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-4, 266],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-2, 273],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [318, -108],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-57, -139],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-471, -93],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-557, -329],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [94, -324],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [438, 253],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-374, -45],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-374, -45],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [34, -21],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [33, -21],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-18, -266],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-68, -251],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-259, 64],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-194, -318],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [319, -280],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-111, 252],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-41, 196],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-17, 172],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [38, 111],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [38, 106],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-52, 79],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-95, 76],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-312, 100],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-319, 100],\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: [-319, 100],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-319, 100],\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: [-319, 100],\n  },\n];\n","import { actionsQueue } from \"../server/actionsQueue\";\nimport { getUrlParameters } from \"./get-url-parameters\";\nimport { generateReplayDatum } from \"../server/testData\";\n\nconst addBots = (count: number) => {\n  for (let index = 0; index < count; index++) {\n    const replayGenerator = generateReplayDatum(\n      Math.floor(Math.random() * 100)\n    );\n    const timeStep = () => {\n      let timeout = 1000 * Math.random();\n      const value = replayGenerator.next().value;\n\n      if (value) {\n        actionsQueue.push({ ...value, id: index.toString() });\n        setTimeout(timeStep, timeout);\n      }\n    };\n    setTimeout(timeStep, 1000);\n  }\n};\nconst botCount = getUrlParameters(\"count\", \"integer\") || 0;\naddBots(botCount);\n","function getParameterByName(name: string) {\n  const url = window.location.href;\n  name = name.replace(/[[\\]]/g, '\\\\$&');\n  const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n    results = regex.exec(url);\n  if (!results) return undefined;\n  if (!results[2]) return '';\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}\nexport function getUrlParameters(name: string, type: 'integer' | 'float'): number | undefined;\nexport function getUrlParameters(name: string, type: 'string'): string | undefined;\nexport function getUrlParameters(name: string, type: 'boolean'): boolean;\nexport function getUrlParameters(\n  name: string,\n  type: 'integer' | 'float' | 'string' | 'boolean',\n): number | string | boolean | undefined {\n  const maybeParam = getParameterByName(name);\n  if (type === 'boolean') {\n    return maybeParam === '';\n  }\n  if (maybeParam === undefined) return undefined;\n\n  switch (type) {\n    case 'integer':\n      return parseInt(maybeParam, 10);\n    case 'float':\n      return parseFloat(maybeParam);\n    case 'string':\n      return maybeParam;\n  }\n}\n","export type V2 = readonly [x: number, y: number];\n\nexport class V2O {\n  static angle([x, y]: V2): number {\n    return Math.atan2(y, x);\n  }\n  static VECTOR_LENGTH = 2;\n  static combine = (\n    a: V2,\n    b: V2,\n    operation: (aElement: number, bElement: number) => number\n  ): V2 => {\n    const result = new Array(V2O.VECTOR_LENGTH);\n\n    for (let index = 0; index < V2O.VECTOR_LENGTH; index++) {\n      const aElement = a[index];\n      const bElement = b[index];\n\n      result[index] = operation(aElement, bElement);\n    }\n\n    return V2O.fromArray(result);\n  };\n\n  static add = (a: V2, b: V2): V2 => V2O.combine(a, b, (a, b) => a + b) as V2;\n\n  static subtract = (base: V2, subtraction: V2): V2 =>\n    V2O.combine(base, subtraction, (a, b) => a - b) as V2;\n\n  static multiply = (base: V2, multiplier: V2): V2 =>\n    V2O.combine(base, multiplier, (a, b) => a * b) as V2;\n\n  static scale = (base: V2, factor: number): V2 =>\n    V2O.fromArray(base.map((element) => element * factor));\n\n  static divide = (base: V2, divisor: V2): V2 =>\n    V2O.combine(base, divisor, (a, b) => a / b) as V2;\n\n  static normalise = (vector: V2): V2 => {\n    const length = V2O.euclideanLength(vector);\n    if (length === 0) {\n      return V2O.zero();\n    }\n    return V2O.scale(vector, 1 / length);\n  };\n\n  static sqrEuclideanLength = (vector: V2): number =>\n    vector[0] ** 2 + vector[1] ** 2;\n\n  static euclideanLength = (vector: V2): number =>\n    V2O.sqrEuclideanLength(vector) ** 0.5;\n\n  static sqrEuclideanDistance = (a: V2, b: V2): number => {\n    const distance = V2O.subtract(a, b);\n    return V2O.sqrEuclideanLength(distance);\n  };\n\n  static euclideanDistanceV2 = (a: V2, b: V2): number => {\n    const distance = V2O.subtract(a, b);\n    return V2O.euclideanLength(distance);\n  };\n\n  static rotate = ([x, y]: V2, angleRadians: number): V2 => {\n    const cos = Math.cos(angleRadians);\n    const sin = Math.sin(angleRadians);\n\n    return [x * cos - y * sin, x * sin + y * cos];\n  };\n\n  static zero = (): V2 => [0, 0];\n  static flipX = (vector: V2): V2 => [-vector[0], vector[1]];\n  static flipY = (vector: V2): V2 => [vector[0], -vector[1]];\n\n  static fromArray = (array: number[]): V2 => {\n    if (array.length !== V2O.VECTOR_LENGTH)\n      throw new Error(\n        `Cannot create V2 from ${array}, length is ${array.length}. Length should be ${V2O.VECTOR_LENGTH}`\n      );\n    return (array as unknown) as V2;\n  };\n\n  static fromVector2 = ({ x, y }: { x: number; y: number }): V2 => [x, y];\n}\n","import { PlayerActions } from \"../common/PlayerActions\";\nimport {\n  IdleData,\n  PeersistentData,\n  PlayerData,\n  TouchingData,\n  Transform,\n} from \"../common/PlayerData\";\nimport { V2, V2O } from \"../common/v2\";\n\nexport class PlayerController {\n  static readonly MAX_CIRCLE_RADIUS = 100;\n  static readonly MIN_CIRCLE_RADIUS = 5;\n  static readonly SPEED = 100;\n\n  static reduceAction(\n    action: PlayerActions,\n    playerData: PlayerData\n  ): PlayerData {\n    switch (action.type) {\n      case \"TOUCH_DOWN\": {\n        switch (playerData.state) {\n          case \"IDLE\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"TOUCHING\",\n              touchPosition: action.position,\n            };\n\n          case \"TOUCHING\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"TOUCHING\",\n              touchPosition: action.position,\n            };\n        }\n        break;\n      }\n\n      case \"TOUCH_UP\":\n        switch (playerData.state) {\n          case \"IDLE\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"IDLE\",\n              idleTarget: action.position,\n            };\n          case \"TOUCHING\": {\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"IDLE\",\n              idleTarget: action.position,\n            };\n          }\n        }\n        break;\n\n      case \"TOUCH_MOVE\": {\n        switch (playerData.state) {\n          case \"IDLE\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"TOUCHING\",\n              touchPosition: action.position,\n            };\n\n          case \"TOUCHING\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"TOUCHING\",\n              touchPosition: action.position,\n            };\n        }\n        break;\n      }\n    }\n  }\n\n  static updateTransform(playerData: PlayerData, deltaTime: number): Transform {\n    switch (playerData.state) {\n      case \"IDLE\":\n        return this.updateIdle(playerData, deltaTime);\n      case \"TOUCHING\":\n        return this.updateTouching(playerData, deltaTime);\n    }\n  }\n\n  private static updateIdle(\n    playerData: PeersistentData & IdleData,\n    deltaTime: number\n  ): Transform {\n    const { position, rotation } = PlayerController.rotateAround(\n      playerData,\n      playerData.idleTarget,\n      deltaTime\n    );\n\n    return { position, rotation };\n  }\n\n  private static rotateAround(\n    playerData: PlayerData,\n    target: V2,\n    deltaTime: number\n  ): Transform {\n    const {\n      transform: { position },\n      rotationDirection,\n    } = playerData;\n    const directionToTarget = V2O.subtract(position, target);\n    const unitToTarget = V2O.normalise(directionToTarget);\n\n    const rotatedUnit = V2O.rotate(\n      unitToTarget,\n      rotationDirection === \"CLOCKWISE\" ? -1 : 1\n    );\n    const scaledUnit = V2O.scale(rotatedUnit, this.MAX_CIRCLE_RADIUS);\n    const rotatedTarget = V2O.add(target, scaledUnit);\n\n    const directionToCircleTarget = V2O.subtract(rotatedTarget, position);\n    const unitToCircleTarget = V2O.normalise(directionToCircleTarget);\n\n    const step = V2O.scale(unitToCircleTarget, this.SPEED * deltaTime);\n    const nextPosition = V2O.add(step, position);\n\n    const rotation = lerpTheta(\n      playerData.transform.rotation,\n      V2O.angle(unitToCircleTarget),\n      0.1\n    );\n\n    return { position: nextPosition, rotation };\n  }\n\n  private static updateTouching(\n    playerData: PeersistentData & TouchingData,\n    deltaTime: number\n  ): Transform {\n    const { position, rotation } = PlayerController.rotateAround(\n      playerData,\n      playerData.touchPosition,\n      deltaTime\n    );\n\n    return { position, rotation };\n  }\n}\n\nfunction lerp(from: number, to: number, amount: number): number {\n  amount = amount < 0 ? 0 : amount;\n  amount = amount > 1 ? 1 : amount;\n  return from + (to - from) * amount;\n}\n\nconst clamp = (value: number, min: number, max: number): number =>\n  Math.min(Math.max(min, value), max);\n\nfunction lerpTheta(\n  from: number,\n  to: number,\n  amount: number,\n  circleAt: number = Math.PI * 2\n) {\n  const removeLoops = (distance: number) =>\n    clamp(distance - Math.floor(distance / circleAt) * circleAt, 0, circleAt);\n\n  const distance = to - from;\n  const unloopedDistance = removeLoops(distance);\n  const isLeft = unloopedDistance > Math.PI;\n  const offset = isLeft ? unloopedDistance - Math.PI * 2 : unloopedDistance;\n  return lerp(from, from + offset, amount);\n}\n","import { PlayerActions } from \"../common/PlayerActions\";\nimport { PlayerController } from \"./PlayerController\";\nimport { PlayerData } from \"../common/PlayerData\";\n\nexport class WorldController {\n  static update(\n    players: PlayerData[],\n    actionsQueue: PlayerActions[],\n    deltaTime: number\n  ) {\n    const actionsThisFrame = [...actionsQueue];\n    actionsQueue.length = 0;\n\n    actionsThisFrame.forEach((action) => {\n      const maybePlayer = players.find((player) => player.id === action.id);\n\n      if (maybePlayer !== undefined) {\n        const nextData = PlayerController.reduceAction(action, maybePlayer);\n        Object.assign(maybePlayer, nextData);\n      } else {\n        WorldController.addPlayerWithAction(action, players);\n      }\n    });\n\n    players.forEach((player) => {\n      const transform = PlayerController.updateTransform(player, deltaTime);\n\n      player.transform = transform;\n    });\n  }\n\n  private static addPlayerWithAction(\n    action: PlayerActions,\n    players: PlayerData[]\n  ) {\n    switch (action.type) {\n      case \"TOUCH_DOWN\":\n        players.push({\n          id: action.id,\n          state: \"TOUCHING\",\n          rotationDirection: \"ANTICLOCKWISE\",\n          touchPosition: action.position,\n          transform: { rotation: 0, position: action.position },\n        });\n        break;\n      case \"TOUCH_MOVE\":\n        players.push({\n          id: action.id,\n          state: \"TOUCHING\",\n          rotationDirection: \"ANTICLOCKWISE\",\n          touchPosition: action.position,\n          transform: { rotation: 0, position: action.position },\n        });\n        break;\n      case \"TOUCH_UP\":\n        players.push({\n          id: action.id,\n          state: \"IDLE\",\n          rotationDirection: \"ANTICLOCKWISE\",\n          idleTarget: action.position,\n          transform: { rotation: 0, position: action.position },\n        });\n        break;\n    }\n  }\n}\n","import { PlayerData } from \"../common/PlayerData\";\n\nexport const connectedPlayers: PlayerData[] = [];\n","import { BoxBufferGeometry } from \"three\";\n\nexport const box = new BoxBufferGeometry();\n","import { MeshBasicMaterial } from \"three\";\n\nexport const pink = new MeshBasicMaterial({ color: \"pink\" });\nexport const blue = new MeshBasicMaterial({ color: \"blue\" });\nexport const green = new MeshBasicMaterial({ color: \"green\" });\n","import { useRef } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nimport { BoxGeometry, Mesh, MeshBasicMaterial, Vector3 } from \"three\";\nimport { PlayerData } from \"../common/PlayerData\";\nimport { box } from \"./geometry\";\nimport { blue } from \"./materials\";\nconst vw = window.innerWidth / 100;\nexport const IdleTarget = ({ data }: { data: PlayerData }) => {\n  const ref = useRef<Mesh<BoxGeometry, MeshBasicMaterial>>();\n\n  useFrame(() => {\n    if (!ref.current) return;\n    if (data.state !== \"IDLE\") {\n      ref.current.visible = false;\n      return;\n    }\n    ref.current.visible = true;\n    const position = data.idleTarget;\n    ref.current.position.set(...position, 0);\n  });\n  return (\n    <mesh\n      ref={ref}\n      name=\"idleTarget\"\n      scale={[1 * vw, 1 * vw, 1]}\n      material={blue}\n      geometry={box}\n    ></mesh>\n  );\n};\n","import React, { useRef } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nimport { Mesh } from \"three\";\nimport { PlayerData } from \"../common/PlayerData\";\nimport { box } from \"./geometry\";\nimport { green } from \"./materials\";\nconst vw = window.innerWidth / 100;\nexport const Player = ({ data }: { data: PlayerData }) => {\n  const ref = useRef<Mesh>();\n\n  useFrame((context, deltaTime) => {\n    if (!ref.current) return;\n\n    const position = data.transform.position;\n    const rotation = data.transform.rotation;\n    ref.current.position.set(...position, 0);\n    ref.current.rotation.set(0, 0, rotation);\n  });\n\n  return (\n    <mesh\n      ref={ref}\n      name=\"player\"\n      scale={[5 * vw, 5 * vw, 1]}\n      position={[0, 0, 0]}\n      material={green}\n      geometry={box}\n    >\n      <mesh\n        position={[0.5, 0, 0]}\n        scale={[0.2, 0.2, 0.2]}\n        material={green}\n        geometry={box}\n      ></mesh>\n    </mesh>\n  );\n};\n","import { useRef } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nimport { BoxGeometry, Mesh, MeshBasicMaterial } from \"three\";\nimport { PlayerData } from \"../common/PlayerData\";\nimport { box } from \"./geometry\";\nimport { pink } from \"./materials\";\nconst vw = window.innerWidth / 100;\nexport const TouchTarget = ({ data }: { data: PlayerData }) => {\n  const ref = useRef<Mesh<BoxGeometry, MeshBasicMaterial>>();\n\n  useFrame(() => {\n    if (!ref.current) return;\n    if (data.state !== \"TOUCHING\") {\n      ref.current.visible = false;\n      return;\n    }\n\n    ref.current.visible = true;\n\n    const position = data.touchPosition;\n    ref.current.position.set(...position, 0);\n  });\n  return (\n    <mesh\n      ref={ref}\n      name=\"touchTarget\"\n      scale={[1 * vw, 1 * vw, 1]}\n      material={pink}\n      geometry={box}\n    ></mesh>\n  );\n};\n","import React, { useState } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nimport { actionsQueue } from \"../server/actionsQueue\";\nimport { WorldController } from \"../server/WorldController\";\nimport { connectedPlayers } from \"../server/connectedPlayers\";\nimport { IdleTarget } from \"./IdleTarget\";\nimport { Player } from \"./Player\";\nimport { TouchTarget } from \"./TouchTarget\";\n\nexport const World = () => {\n  const [playerIds, setPlayerIds] = useState<string[]>([]);\n  useFrame((context, deltaTime) => {\n    WorldController.update(connectedPlayers, actionsQueue, deltaTime);\n    const nextPlayerIds = connectedPlayers.map((player) => player.id);\n    const diff = nextPlayerIds.some((id) => !playerIds.includes(id));\n    if (diff) {\n      setPlayerIds(nextPlayerIds);\n    }\n  });\n\n  const targets = playerIds.map((id, playerIndex) => {\n    const player = connectedPlayers.find((player) => player.id === id);\n    if (!player) return null;\n    return (\n      <React.Fragment key={id}>\n        <IdleTarget data={player} />\n        <TouchTarget data={player} />\n      </React.Fragment>\n    );\n  });\n\n  const playerComponents = playerIds.map((id, playerIndex) => {\n    const player = connectedPlayers.find((player) => player.id === id);\n    if (!player) return null;\n\n    return <Player data={player} key={id} />;\n  });\n\n  return (\n    <>\n      {targets}\n      {playerComponents}\n    </>\n  );\n};\n","import React, { useRef } from \"react\";\nimport { Canvas } from \"react-three-fiber\";\nimport { actionsQueue } from \"../server/actionsQueue\";\nimport { PlayerActions } from \"../common/PlayerActions\";\nimport \"./addBots\";\nimport \"./App.css\";\nimport { World } from \"./World\";\n\nconst canvasCoords = (event: React.MouseEvent) => {\n  return [\n    event.clientX - window.innerWidth / 2,\n    -event.clientY + window.innerHeight / 2,\n  ] as const;\n};\n\nfunction App() {\n  const isTouching = useRef(false);\n\n  const onMouseDown = (\n    event: React.MouseEvent<HTMLDivElement, MouseEvent>\n  ): void => {\n    const position = canvasCoords(event);\n    const action: PlayerActions = {\n      type: \"TOUCH_DOWN\",\n      id: \"TEST\",\n      position,\n    };\n    actionsQueue.push(action);\n\n    isTouching.current = true;\n  };\n\n  const onMouseMove = (\n    event: React.MouseEvent<HTMLDivElement, MouseEvent>\n  ): void => {\n    if (!isTouching.current) return;\n\n    const position = canvasCoords(event);\n    const action: PlayerActions = {\n      type: \"TOUCH_MOVE\",\n      id: \"TEST\",\n      position,\n    };\n    actionsQueue.push(action);\n  };\n\n  const onMouseUp = (\n    event: React.MouseEvent<HTMLDivElement, MouseEvent>\n  ): void => {\n    const position = canvasCoords(event);\n\n    const action: PlayerActions = {\n      type: \"TOUCH_UP\",\n      id: \"TEST\",\n      position: position,\n    };\n    actionsQueue.push(action);\n\n    isTouching.current = false;\n  };\n\n  return (\n    <div className=\"App\">\n      <Canvas\n        orthographic={true}\n        pixelRatio={window.devicePixelRatio}\n        concurrent={true}\n        style={{ width: \"100%\", height: \"100%\" }}\n        onPointerDown={onMouseDown}\n        onPointerMove={onMouseMove}\n        onPointerUp={onMouseUp}\n      >\n        <World />\n      </Canvas>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./client/App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}