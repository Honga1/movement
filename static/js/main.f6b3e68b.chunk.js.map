{"version":3,"sources":["IdleTarget.tsx","Player.tsx","PlayerData.tsx","PlayerController.tsx","testData.ts","TouchTarget.tsx","App.tsx","get-url-parameters.tsx","useAnimationFrame.tsx","index.tsx"],"names":["vw","window","innerWidth","IdleTarget","data","idleTarget","useRef","useFrame","current","position","copy","Vector3","x","y","ref","name","scale","color","Player","html","context","deltaTime","transform","rotation","set","innerHTML","state","Html","style","PlayerController","action","playerData","type","id","rotationDirection","touchPosition","this","updateIdle","updateTouching","unitToCircleTarget","objectToVector2","clone","sub","normalize","rotateAround","Vector2","multiplyScalar","MAX_CIRCLE_RADIUS","add","SPEED","lerpTheta","angle","MIN_CIRCLE_RADIUS","lerp","from","to","amount","clamp","value","min","max","Math","circleAt","PI","removeLoops","distance","floor","unloopedDistance","isLeft","offset","generateReplayDatum","nextIndex","replayData","length","TouchTarget","actionsQueue","canvasCoords","event","clientX","clientY","innerHeight","count","index","replayGenerator","random","setTimeout","timeStep","timeout","next","push","toString","addBots","maybeParam","url","location","href","replace","results","RegExp","exec","decodeURIComponent","getParameterByName","undefined","parseInt","parseFloat","getUrlParameters","App","useState","actionsHistory","setActionsHistory","isTouching","setIsTouching","players","setPlayers","frameRate","callback","requestRef","previousTimeRef","animate","useCallback","time","useEffect","interval","setInterval","requestAnimationFrame","cancelAnimationFrame","clearInterval","useAnimationFrame","nextPlayers","actionsThisFrame","forEach","maybePlayerIndex","findIndex","player","nextData","reduceAction","Object","assign","updateTransform","update","className","slice","map","orthographic","pixelRatio","devicePixelRatio","concurrent","width","height","onMouseDown","onMouseMove","onMouseUp","playerIndex","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f6b3e68b.chunk.js","sourcesContent":["import { useRef } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nimport { BoxGeometry, Mesh, MeshBasicMaterial, Vector3 } from \"three\";\nimport { IdleData } from \"./PlayerData\";\nconst vw = window.innerWidth / 100;\nexport const IdleTarget = ({ data }: { data: IdleData }) => {\n  const idleTarget = useRef<Mesh<BoxGeometry, MeshBasicMaterial>>();\n\n  useFrame(() => {\n    if (!idleTarget.current) return;\n    const position = data.idleTarget;\n\n    idleTarget.current.position.copy(new Vector3(position.x, position.y, 0));\n  });\n  return (\n    <mesh ref={idleTarget} name=\"idleTarget\" scale={[1 * vw, 1 * vw, 1]}>\n      <boxGeometry />\n      <meshBasicMaterial color=\"blue\" />\n    </mesh>\n  );\n};\n","import React, { useRef } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nimport { Mesh, Vector3 } from \"three\";\nimport { PlayerData } from \"./PlayerData\";\nimport { Html } from \"drei\";\nconst vw = window.innerWidth / 100;\nexport const Player = ({ data }: { data: PlayerData }) => {\n  const ref = useRef<Mesh>();\n\n  const html = useRef<HTMLDivElement>();\n\n  useFrame((context, deltaTime) => {\n    if (!ref.current) return;\n    const position = data.transform.position;\n    const rotation = data.transform.rotation;\n    ref.current.position.copy(new Vector3(position.x, position.y, 0));\n    ref.current.rotation.set(0, 0, rotation);\n\n    if (html.current) {\n      html.current.innerHTML = data.state;\n    }\n  });\n\n  return (\n    <mesh\n      ref={ref}\n      name=\"player\"\n      scale={[5 * vw, 5 * vw, 1]}\n      position={[0, 0, 0]}\n    >\n      <boxGeometry />\n      <meshBasicMaterial color=\"green\" />\n      <mesh position={[0.5, 0, 0]} scale={[0.2, 0.2, 0.2]}>\n        <boxGeometry />\n        <meshBasicMaterial color=\"green\" />\n      </mesh>\n      <Html style={{ color: \"white\" }} ref={html}></Html>\n    </mesh>\n  );\n};\n","export interface Transform {\n  position: { x: number; y: number };\n  rotation: number;\n}\nexport const vw = window.innerWidth / 100;\nexport interface IdleData {\n  state: \"IDLE\";\n  idleTarget: { x: number; y: number };\n}\nexport type TouchingData = {\n  state: \"TOUCHING\";\n  touchPosition: { x: number; y: number };\n};\nexport type PeersistentData = {\n  id: string;\n  transform: Transform;\n  rotationDirection: \"CLOCKWISE\" | \"ANTICLOCKWISE\";\n};\ntype StateDependentData = IdleData | TouchingData;\nexport type PlayerData = PeersistentData & StateDependentData;\n","import { Vector2 } from \"three\";\nimport { PlayerActions } from \"./PlayerActions\";\nimport {\n  vw,\n  PlayerData,\n  PeersistentData,\n  IdleData,\n  Transform,\n  TouchingData,\n} from \"./PlayerData\";\n\nexport class PlayerController {\n  static readonly MAX_CIRCLE_RADIUS = 10 * vw;\n  static readonly MIN_CIRCLE_RADIUS = 5;\n  static readonly SPEED = 100;\n\n  static reduceAction(\n    action: PlayerActions,\n    playerData: PlayerData\n  ): PlayerData {\n    switch (action.type) {\n      case \"TOUCH_DOWN\": {\n        switch (playerData.state) {\n          case \"IDLE\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"TOUCHING\",\n              touchPosition: action.position,\n            };\n\n          case \"TOUCHING\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"TOUCHING\",\n              touchPosition: action.position,\n            };\n        }\n        break;\n      }\n\n      case \"TOUCH_UP\":\n        switch (playerData.state) {\n          case \"IDLE\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"IDLE\",\n              idleTarget: action.position,\n            };\n          case \"TOUCHING\": {\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"IDLE\",\n              idleTarget: action.position,\n            };\n          }\n        }\n        break;\n\n      case \"TOUCH_MOVE\": {\n        switch (playerData.state) {\n          case \"IDLE\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"TOUCHING\",\n              touchPosition: action.position,\n            };\n\n          case \"TOUCHING\":\n            return {\n              id: playerData.id,\n              transform: playerData.transform,\n              rotationDirection: playerData.rotationDirection,\n              state: \"TOUCHING\",\n              touchPosition: action.position,\n            };\n        }\n        break;\n      }\n    }\n  }\n\n  static updateTransform(playerData: PlayerData, deltaTime: number): Transform {\n    switch (playerData.state) {\n      case \"IDLE\":\n        return this.updateIdle(playerData, deltaTime);\n      case \"TOUCHING\":\n        return this.updateTouching(playerData, deltaTime);\n    }\n  }\n\n  private static updateIdle(\n    playerData: PeersistentData & IdleData,\n    deltaTime: number\n  ): Transform {\n    const {\n      idleTarget,\n      transform: { position },\n      rotationDirection,\n    } = playerData;\n\n    const directionToTarget = objectToVector2(position)\n      .clone()\n      .sub(objectToVector2(idleTarget));\n    const unitToTarget = directionToTarget.clone().normalize();\n\n    const rotatedTarget = unitToTarget\n      .clone()\n      .rotateAround(\n        new Vector2(0, 0),\n        rotationDirection === \"CLOCKWISE\" ? -1 : 1\n      )\n      .multiplyScalar(this.MAX_CIRCLE_RADIUS)\n      .add(objectToVector2(idleTarget));\n\n    const directionToCircleTarget = rotatedTarget\n      .clone()\n      .sub(objectToVector2(position));\n    const unitToCircleTarget = directionToCircleTarget.clone().normalize();\n\n    const step = unitToCircleTarget\n      .clone()\n      .multiplyScalar(this.SPEED)\n      .multiplyScalar(deltaTime);\n    const nextPosition = step.clone().add(objectToVector2(position));\n\n    const rotation = lerpTheta(\n      playerData.transform.rotation,\n      unitToCircleTarget.angle(),\n      0.1\n    );\n    return { position: nextPosition, rotation };\n  }\n  private static updateTouching(\n    playerData: PeersistentData & TouchingData,\n    deltaTime: number\n  ): Transform {\n    const {\n      touchPosition,\n      transform: { position },\n      rotationDirection,\n    } = playerData;\n\n    const directionToTarget = objectToVector2(position)\n      .clone()\n      .sub(objectToVector2(touchPosition));\n    const unitToTarget = directionToTarget.clone().normalize();\n\n    const rotatedTarget = unitToTarget\n      .clone()\n      .rotateAround(\n        new Vector2(0, 0),\n        rotationDirection === \"CLOCKWISE\" ? -1 : 1\n      )\n      .multiplyScalar(this.MAX_CIRCLE_RADIUS)\n      .add(objectToVector2(touchPosition));\n\n    const directionToCircleTarget = rotatedTarget\n      .clone()\n      .sub(objectToVector2(position));\n    const unitToCircleTarget = directionToCircleTarget.clone().normalize();\n\n    const step = unitToCircleTarget\n      .clone()\n      .multiplyScalar(this.SPEED)\n      .multiplyScalar(deltaTime);\n    const nextPosition = step.clone().add(objectToVector2(position));\n\n    const rotation = lerpTheta(\n      playerData.transform.rotation,\n      unitToCircleTarget.angle(),\n      0.2\n    );\n    return { position: nextPosition, rotation };\n  }\n}\n\nconst objectToVector2 = ({ x, y }: { x: number; y: number }) => {\n  return new Vector2(x, y);\n};\n\nfunction lerp(from: number, to: number, amount: number): number {\n  amount = amount < 0 ? 0 : amount;\n  amount = amount > 1 ? 1 : amount;\n  return from + (to - from) * amount;\n}\n\nconst clamp = (value: number, min: number, max: number): number =>\n  Math.min(Math.max(min, value), max);\n\nfunction lerpTheta(\n  from: number,\n  to: number,\n  amount: number,\n  circleAt: number = Math.PI * 2\n) {\n  const removeLoops = (distance: number) =>\n    clamp(distance - Math.floor(distance / circleAt) * circleAt, 0, circleAt);\n\n  const distance = to - from;\n  const unloopedDistance = removeLoops(distance);\n  const isLeft = unloopedDistance > Math.PI;\n  const offset = isLeft ? unloopedDistance - Math.PI * 2 : unloopedDistance;\n  return lerp(from, from + offset, amount);\n}\n","import { PlayerActions } from \"./PlayerActions\";\n\nexport function* generateReplayDatum(offset: number) {\n  let nextIndex = offset;\n\n  while (true) {\n    nextIndex++;\n    yield replayData[nextIndex % replayData.length];\n  }\n}\nexport const replayData: PlayerActions[] = [\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -351,\n      y: 111,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -389,\n      y: 65,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -391,\n      y: 55,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -389,\n      y: 54,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -377,\n      y: 54,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -373,\n      y: 53,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -259,\n      y: 55,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -124,\n      y: 39,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -61,\n      y: 32,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -11,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -12,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -12,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -13,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -15,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -15,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -15,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -15,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -15,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -15,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -17,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -17,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -17,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -17,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -17,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -17,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -17,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -18,\n      y: 22,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -21,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -23,\n      y: 21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -38,\n      y: 16,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -39,\n      y: 15,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -40,\n      y: 13,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -40,\n      y: 13,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -41,\n      y: -4,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -39,\n      y: -11,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -27,\n      y: -37,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -18,\n      y: -39,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -8,\n      y: -49,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -8,\n      y: -49,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 5,\n      y: -54,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: 5,\n      y: -55,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 6,\n      y: -55,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: 10,\n      y: -55,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -32,\n      y: -82,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -42,\n      y: -82,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -109,\n      y: -95,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -126,\n      y: -97,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -131,\n      y: -201,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -90,\n      y: -283,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 27,\n      y: -338,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: 134,\n      y: -279,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 134,\n      y: -261,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: 123,\n      y: -74,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 66,\n      y: 108,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: 57,\n      y: 119,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -154,\n      y: 47,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -360,\n      y: -214,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -22,\n      y: -234,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -22,\n      y: -234,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -4,\n      y: 266,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -2,\n      y: 273,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 318,\n      y: -108,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -57,\n      y: -139,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -471,\n      y: -93,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -557,\n      y: -329,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 94,\n      y: -324,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: 438,\n      y: 253,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -374,\n      y: -45,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -374,\n      y: -45,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 34,\n      y: -21,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: 33,\n      y: -21,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -18,\n      y: -266,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -68,\n      y: -251,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -259,\n      y: 64,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -194,\n      y: -318,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 319,\n      y: -280,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -111,\n      y: 252,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -41,\n      y: 196,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -17,\n      y: 172,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: 38,\n      y: 111,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: 38,\n      y: 106,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -52,\n      y: 79,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -95,\n      y: 76,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -312,\n      y: 100,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -319,\n      y: 100,\n    },\n  },\n  {\n    type: \"TOUCH_UP\",\n    id: \"REPLAY\",\n    position: {\n      x: -319,\n      y: 100,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -319,\n      y: 100,\n    },\n  },\n  {\n    type: \"TOUCH_DOWN\",\n    id: \"REPLAY\",\n    position: {\n      x: -319,\n      y: 100,\n    },\n  },\n];\n","import { useRef } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nimport { BoxGeometry, Mesh, MeshBasicMaterial, Vector3 } from \"three\";\nimport { TouchingData } from \"./PlayerData\";\nconst vw = window.innerWidth / 100;\nexport const TouchTarget = ({ data }: { data: TouchingData }) => {\n  const ref = useRef<Mesh<BoxGeometry, MeshBasicMaterial>>();\n\n  useFrame(() => {\n    if (!ref.current) return;\n    const position = data.touchPosition;\n    ref.current.position.copy(new Vector3(position.x, position.y, 0));\n  });\n  return (\n    <mesh ref={ref} name=\"touchTarget\" scale={[1 * vw, 1 * vw, 1]}>\n      <boxGeometry />\n      <meshBasicMaterial color=\"pink\" />\n    </mesh>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { Canvas } from \"react-three-fiber\";\nimport { Vector2 } from \"three\";\nimport \"./App.css\";\nimport { getUrlParameters } from \"./get-url-parameters\";\nimport { IdleTarget } from \"./IdleTarget\";\nimport { Player } from \"./Player\";\nimport { PlayerActions } from \"./PlayerActions\";\nimport { PlayerController } from \"./PlayerController\";\nimport { PlayerData } from \"./PlayerData\";\nimport { generateReplayDatum, replayData } from \"./testData\";\nimport { TouchTarget } from \"./TouchTarget\";\nimport { useAnimationFrame } from \"./useAnimationFrame\";\nexport const actionsQueue: PlayerActions[] = [];\n\nconst canvasCoords = (event: React.MouseEvent) => {\n  return {\n    x: event.clientX - window.innerWidth / 2,\n    y: -event.clientY + window.innerHeight / 2,\n  };\n};\n\nconst addBots = (count: number) => {\n  for (let index = 0; index < count; index++) {\n    const replayGenerator = generateReplayDatum(\n      Math.floor(Math.random() * 100)\n    );\n    const timeStep = () => {\n      let timeout = 1000 * Math.random();\n      const value = replayGenerator.next().value;\n\n      if (value) {\n        actionsQueue.push({ ...value, id: index.toString() });\n        setTimeout(timeStep, timeout);\n      }\n    };\n    setTimeout(timeStep, 1000);\n  }\n};\n\nconst botCount = getUrlParameters(\"count\", \"integer\") || 2;\naddBots(botCount);\n\nfunction App() {\n  const [actionsHistory, setActionsHistory] = useState(actionsQueue);\n  const [isTouching, setIsTouching] = useState(false);\n  const [players, setPlayers] = useState<PlayerData[]>([\n    {\n      id: \"TEST\",\n      state: \"IDLE\",\n      transform: { position: new Vector2(100, 100), rotation: 0 },\n      idleTarget: new Vector2(),\n      rotationDirection: \"CLOCKWISE\",\n    },\n  ]);\n\n  useAnimationFrame(60, (deltaTime) => {\n    const nextPlayers = update(players, deltaTime);\n    setPlayers([...nextPlayers]);\n  });\n\n  return (\n    <div className=\"App\">\n      <div style={{ position: \"absolute\" }}>\n        {actionsHistory.slice(0, 10).map((action, index) => (\n          <div key={index}>{`${action.type}`}</div>\n        ))}\n      </div>\n      <Canvas\n        orthographic={true}\n        pixelRatio={window.devicePixelRatio}\n        concurrent={true}\n        style={{ width: \"100%\", height: \"100%\" }}\n        onMouseDown={(event) => {\n          const { x, y } = canvasCoords(event);\n          const action: PlayerActions = {\n            type: \"TOUCH_DOWN\",\n            id: \"TEST\",\n            position: new Vector2(x, y),\n          };\n          actionsQueue.push(action);\n\n          setIsTouching(true);\n          setActionsHistory([action, ...actionsHistory]);\n        }}\n        onMouseMove={(event) => {\n          if (!isTouching) return;\n\n          const { x, y } = canvasCoords(event);\n          const action: PlayerActions = {\n            type: \"TOUCH_MOVE\",\n            id: \"TEST\",\n            position: new Vector2(x, y),\n          };\n          actionsQueue.push(action);\n\n          const firstAction = actionsHistory[0];\n          if (firstAction.type === action.type) {\n            setActionsHistory([action, ...actionsHistory]);\n          }\n        }}\n        onMouseUp={(event) => {\n          const { x, y } = canvasCoords(event);\n\n          const action: PlayerActions = {\n            type: \"TOUCH_UP\",\n            id: \"TEST\",\n            position: new Vector2(x, y),\n          };\n          actionsQueue.push(action);\n\n          setIsTouching(false);\n          setActionsHistory([action, ...actionsHistory]);\n        }}\n      >\n        {players.map((player, playerIndex) => (\n          <Player data={player} key={playerIndex} />\n        ))}\n        {players.map((player, playerIndex) => {\n          if (player.state === \"IDLE\") {\n            return <IdleTarget data={player} key={playerIndex} />;\n          } else if (player.state === \"TOUCHING\") {\n            return <TouchTarget data={player} key={playerIndex} />;\n          }\n          return null;\n        })}\n      </Canvas>\n    </div>\n  );\n}\n\nexport default App;\nfunction update(players: PlayerData[], deltaTime: number) {\n  const actionsThisFrame = [...actionsQueue];\n  actionsQueue.length = 0;\n\n  actionsThisFrame.forEach((action) => {\n    const maybePlayerIndex = players.findIndex(\n      (player) => player.id === action.id\n    );\n\n    const playerExists = maybePlayerIndex !== -1;\n    if (playerExists) {\n      const player = players[maybePlayerIndex];\n      const nextData = PlayerController.reduceAction(action, player);\n      Object.assign(players[maybePlayerIndex], nextData);\n    } else {\n      switch (action.type) {\n        case \"TOUCH_DOWN\":\n          players.push({\n            id: action.id,\n            state: \"TOUCHING\",\n            rotationDirection: \"ANTICLOCKWISE\",\n            touchPosition: action.position,\n            transform: { rotation: 0, position: action.position },\n          });\n          break;\n        case \"TOUCH_MOVE\":\n          players.push({\n            id: action.id,\n            state: \"TOUCHING\",\n            rotationDirection: \"ANTICLOCKWISE\",\n            touchPosition: action.position,\n            transform: { rotation: 0, position: action.position },\n          });\n          break;\n        case \"TOUCH_UP\":\n          players.push({\n            id: action.id,\n            state: \"IDLE\",\n            rotationDirection: \"ANTICLOCKWISE\",\n            idleTarget: action.position,\n            transform: { rotation: 0, position: action.position },\n          });\n          break;\n      }\n    }\n  });\n\n  players.forEach((player) => {\n    const transform = PlayerController.updateTransform(\n      player,\n      deltaTime / 1000\n    );\n    Object.assign(player.transform.position, transform.position);\n    player.transform.rotation = transform.rotation;\n  });\n\n  return players;\n}\n","function getParameterByName(name: string) {\n  const url = window.location.href;\n  name = name.replace(/[[\\]]/g, '\\\\$&');\n  const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n    results = regex.exec(url);\n  if (!results) return undefined;\n  if (!results[2]) return '';\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}\nexport function getUrlParameters(name: string, type: 'integer' | 'float'): number | undefined;\nexport function getUrlParameters(name: string, type: 'string'): string | undefined;\nexport function getUrlParameters(name: string, type: 'boolean'): boolean;\nexport function getUrlParameters(\n  name: string,\n  type: 'integer' | 'float' | 'string' | 'boolean',\n): number | string | boolean | undefined {\n  const maybeParam = getParameterByName(name);\n  if (type === 'boolean') {\n    return maybeParam === '';\n  }\n  if (maybeParam === undefined) return undefined;\n\n  switch (type) {\n    case 'integer':\n      return parseInt(maybeParam, 10);\n    case 'float':\n      return parseFloat(maybeParam);\n    case 'string':\n      return maybeParam;\n  }\n}\n","import { useCallback, useEffect, useRef } from \"react\";\n\nexport const useAnimationFrame = (\n  frameRate: number,\n  callback: (deltaTime: number) => void\n): void => {\n  const requestRef = useRef<number>();\n  const previousTimeRef = useRef<number>();\n\n  const animate = useCallback(\n    (time: number) => {\n      if (previousTimeRef.current !== undefined) {\n        const deltaTime = time - previousTimeRef.current;\n        callback(deltaTime);\n      }\n      previousTimeRef.current = time;\n    },\n    [callback]\n  );\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      requestRef.current = requestAnimationFrame(animate);\n    }, 1000 / frameRate);\n    return () => {\n      requestRef.current && cancelAnimationFrame(requestRef.current);\n      interval && clearInterval(interval);\n    };\n  }, [animate, frameRate]);\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}