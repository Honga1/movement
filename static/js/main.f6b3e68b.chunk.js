(this.webpackJsonpmovement=this.webpackJsonpmovement||[]).push([[0],{33:function(t,i,o){},34:function(t,i,o){},39:function(t,i,o){"use strict";o.r(i);var e=o(6),n=o(0),r=o.n(n),s=o(13),p=o.n(s),a=(o(33),o(8)),c=o(7),y=o(4),O=o(10),d=o(3);o(34);var U=window.innerWidth/100,P=function(t){var i=t.data,o=Object(n.useRef)();return Object(O.b)((function(){if(o.current){var t=i.idleTarget;o.current.position.copy(new d.Vector3(t.x,t.y,0))}})),Object(e.jsxs)("mesh",{ref:o,name:"idleTarget",scale:[1*U,1*U,1],children:[Object(e.jsx)("boxGeometry",{}),Object(e.jsx)("meshBasicMaterial",{color:"blue"})]})},u=o(41),x=window.innerWidth/100,T=function(t){var i=t.data,o=Object(n.useRef)(),r=Object(n.useRef)();return Object(O.b)((function(t,e){if(o.current){var n=i.transform.position,s=i.transform.rotation;o.current.position.copy(new d.Vector3(n.x,n.y,0)),o.current.rotation.set(0,0,s),r.current&&(r.current.innerHTML=i.state)}})),Object(e.jsxs)("mesh",{ref:o,name:"player",scale:[5*x,5*x,1],position:[0,0,0],children:[Object(e.jsx)("boxGeometry",{}),Object(e.jsx)("meshBasicMaterial",{color:"green"}),Object(e.jsxs)("mesh",{position:[.5,0,0],scale:[.2,.2,.2],children:[Object(e.jsx)("boxGeometry",{}),Object(e.jsx)("meshBasicMaterial",{color:"green"})]}),Object(e.jsx)(u.a,{style:{color:"white"},ref:r})]})},C=o(1),E=o(2),H=window.innerWidth/100,L=function(){function t(){Object(C.a)(this,t)}return Object(E.a)(t,null,[{key:"reduceAction",value:function(t,i){switch(t.type){case"TOUCH_DOWN":switch(i.state){case"IDLE":case"TOUCHING":return{id:i.id,transform:i.transform,rotationDirection:i.rotationDirection,state:"TOUCHING",touchPosition:t.position}}break;case"TOUCH_UP":switch(i.state){case"IDLE":case"TOUCHING":return{id:i.id,transform:i.transform,rotationDirection:i.rotationDirection,state:"IDLE",idleTarget:t.position}}break;case"TOUCH_MOVE":switch(i.state){case"IDLE":case"TOUCHING":return{id:i.id,transform:i.transform,rotationDirection:i.rotationDirection,state:"TOUCHING",touchPosition:t.position}}}}},{key:"updateTransform",value:function(t,i){switch(t.state){case"IDLE":return this.updateIdle(t,i);case"TOUCHING":return this.updateTouching(t,i)}}},{key:"updateIdle",value:function(t,i){var o=t.idleTarget,e=t.transform.position,n=t.rotationDirection,r=R(e).clone().sub(R(o)).clone().normalize().clone().rotateAround(new d.Vector2(0,0),"CLOCKWISE"===n?-1:1).multiplyScalar(this.MAX_CIRCLE_RADIUS).add(R(o)).clone().sub(R(e)).clone().normalize();return{position:r.clone().multiplyScalar(this.SPEED).multiplyScalar(i).clone().add(R(e)),rotation:l(t.transform.rotation,r.angle(),.1)}}},{key:"updateTouching",value:function(t,i){var o=t.touchPosition,e=t.transform.position,n=t.rotationDirection,r=R(e).clone().sub(R(o)).clone().normalize().clone().rotateAround(new d.Vector2(0,0),"CLOCKWISE"===n?-1:1).multiplyScalar(this.MAX_CIRCLE_RADIUS).add(R(o)).clone().sub(R(e)).clone().normalize();return{position:r.clone().multiplyScalar(this.SPEED).multiplyScalar(i).clone().add(R(e)),rotation:l(t.transform.rotation,r.angle(),.2)}}}]),t}();L.MAX_CIRCLE_RADIUS=10*H,L.MIN_CIRCLE_RADIUS=5,L.SPEED=100;var R=function(t){var i=t.x,o=t.y;return new d.Vector2(i,o)};function _(t,i,o){return t+(i-t)*(o=(o=o<0?0:o)>1?1:o)}var A=function(t,i,o){return Math.min(Math.max(i,t),o)};function l(t,i,o){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI,n=function(t){return A(t-Math.floor(t/e)*e,0,e)},r=i-t,s=n(r),p=s>Math.PI,a=p?s-2*Math.PI:s;return _(t,t+a,o)}var Y=o(24),f=o.n(Y),D=f.a.mark(h);function h(t){var i;return f.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=t;case 1:return i++,o.next=5,j[i%j.length];case 5:o.next=1;break;case 7:case"end":return o.stop()}}),D)}var j=[{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-351,y:111}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-389,y:65}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-391,y:55}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-389,y:54}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-377,y:54}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-373,y:53}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-259,y:55}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-124,y:39}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-61,y:32}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-11,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-12,y:21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-12,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-13,y:21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-15,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-15,y:22}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-15,y:22}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-15,y:22}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-15,y:22}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-15,y:22}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-17,y:22}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-17,y:22}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-17,y:22}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-17,y:22}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-17,y:22}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-17,y:22}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-17,y:22}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-18,y:22}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-21,y:21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-23,y:21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-38,y:16}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-39,y:15}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-40,y:13}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-40,y:13}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-41,y:-4}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-39,y:-11}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-27,y:-37}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-18,y:-39}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-8,y:-49}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-8,y:-49}},{type:"TOUCH_UP",id:"REPLAY",position:{x:5,y:-54}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:5,y:-55}},{type:"TOUCH_UP",id:"REPLAY",position:{x:6,y:-55}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:10,y:-55}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-32,y:-82}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-42,y:-82}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-109,y:-95}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-126,y:-97}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-131,y:-201}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-90,y:-283}},{type:"TOUCH_UP",id:"REPLAY",position:{x:27,y:-338}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:134,y:-279}},{type:"TOUCH_UP",id:"REPLAY",position:{x:134,y:-261}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:123,y:-74}},{type:"TOUCH_UP",id:"REPLAY",position:{x:66,y:108}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:57,y:119}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-154,y:47}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-360,y:-214}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-22,y:-234}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-22,y:-234}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-4,y:266}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-2,y:273}},{type:"TOUCH_UP",id:"REPLAY",position:{x:318,y:-108}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-57,y:-139}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-471,y:-93}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-557,y:-329}},{type:"TOUCH_UP",id:"REPLAY",position:{x:94,y:-324}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:438,y:253}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-374,y:-45}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-374,y:-45}},{type:"TOUCH_UP",id:"REPLAY",position:{x:34,y:-21}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:33,y:-21}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-18,y:-266}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-68,y:-251}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-259,y:64}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-194,y:-318}},{type:"TOUCH_UP",id:"REPLAY",position:{x:319,y:-280}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-111,y:252}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-41,y:196}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-17,y:172}},{type:"TOUCH_UP",id:"REPLAY",position:{x:38,y:111}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:38,y:106}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-52,y:79}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-95,y:76}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-312,y:100}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-319,y:100}},{type:"TOUCH_UP",id:"REPLAY",position:{x:-319,y:100}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-319,y:100}},{type:"TOUCH_DOWN",id:"REPLAY",position:{x:-319,y:100}}],b=window.innerWidth/100,m=function(t){var i=t.data,o=Object(n.useRef)();return Object(O.b)((function(){if(o.current){var t=i.touchPosition;o.current.position.copy(new d.Vector3(t.x,t.y,0))}})),Object(e.jsxs)("mesh",{ref:o,name:"touchTarget",scale:[1*b,1*b,1],children:[Object(e.jsx)("boxGeometry",{}),Object(e.jsx)("meshBasicMaterial",{color:"pink"})]})},N=[],W=function(t){return{x:t.clientX-window.innerWidth/2,y:-t.clientY+window.innerHeight/2}};!function(t){for(var i=function(t){var i=h(Math.floor(100*Math.random()));setTimeout((function o(){var e=1e3*Math.random(),n=i.next().value;n&&(N.push(Object(y.a)(Object(y.a)({},n),{},{id:t.toString()})),setTimeout(o,e))}),1e3)},o=0;o<t;o++)i(o)}(function(t,i){var o=function(t){var i=window.location.href;t=t.replace(/[[\]]/g,"\\$&");var o=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(i);if(o)return o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):""}(t);if("boolean"===i)return""===o;if(void 0!==o)switch(i){case"integer":return parseInt(o,10);case"float":return parseFloat(o);case"string":return o}}("count","integer")||2);var v=function(){var t=Object(n.useState)(N),i=Object(c.a)(t,2),o=i[0],r=i[1],s=Object(n.useState)(!1),p=Object(c.a)(s,2),y=p[0],U=p[1],u=Object(n.useState)([{id:"TEST",state:"IDLE",transform:{position:new d.Vector2(100,100),rotation:0},idleTarget:new d.Vector2,rotationDirection:"CLOCKWISE"}]),x=Object(c.a)(u,2),C=x[0],E=x[1];return function(t,i){var o=Object(n.useRef)(),e=Object(n.useRef)(),r=Object(n.useCallback)((function(t){if(void 0!==e.current){var o=t-e.current;i(o)}e.current=t}),[i]);Object(n.useEffect)((function(){var i=setInterval((function(){o.current=requestAnimationFrame(r)}),1e3/t);return function(){o.current&&cancelAnimationFrame(o.current),i&&clearInterval(i)}}),[r,t])}(60,(function(t){var i=function(t,i){var o=[].concat(N);return N.length=0,o.forEach((function(i){var o=t.findIndex((function(t){return t.id===i.id}));if(-1!==o){var e=t[o],n=L.reduceAction(i,e);Object.assign(t[o],n)}else switch(i.type){case"TOUCH_DOWN":case"TOUCH_MOVE":t.push({id:i.id,state:"TOUCHING",rotationDirection:"ANTICLOCKWISE",touchPosition:i.position,transform:{rotation:0,position:i.position}});break;case"TOUCH_UP":t.push({id:i.id,state:"IDLE",rotationDirection:"ANTICLOCKWISE",idleTarget:i.position,transform:{rotation:0,position:i.position}})}})),t.forEach((function(t){var o=L.updateTransform(t,i/1e3);Object.assign(t.transform.position,o.position),t.transform.rotation=o.rotation})),t}(C,t);E(Object(a.a)(i))})),Object(e.jsxs)("div",{className:"App",children:[Object(e.jsx)("div",{style:{position:"absolute"},children:o.slice(0,10).map((function(t,i){return Object(e.jsx)("div",{children:"".concat(t.type)},i)}))}),Object(e.jsxs)(O.a,{orthographic:!0,pixelRatio:window.devicePixelRatio,concurrent:!0,style:{width:"100%",height:"100%"},onMouseDown:function(t){var i=W(t),e=i.x,n=i.y,s={type:"TOUCH_DOWN",id:"TEST",position:new d.Vector2(e,n)};N.push(s),U(!0),r([s].concat(Object(a.a)(o)))},onMouseMove:function(t){if(y){var i=W(t),e=i.x,n=i.y,s={type:"TOUCH_MOVE",id:"TEST",position:new d.Vector2(e,n)};N.push(s),o[0].type===s.type&&r([s].concat(Object(a.a)(o)))}},onMouseUp:function(t){var i=W(t),e=i.x,n=i.y,s={type:"TOUCH_UP",id:"TEST",position:new d.Vector2(e,n)};N.push(s),U(!1),r([s].concat(Object(a.a)(o)))},children:[C.map((function(t,i){return Object(e.jsx)(T,{data:t},i)})),C.map((function(t,i){return"IDLE"===t.state?Object(e.jsx)(P,{data:t},i):"TOUCHING"===t.state?Object(e.jsx)(m,{data:t},i):null}))]})]})};p.a.render(Object(e.jsx)(r.a.StrictMode,{children:Object(e.jsx)(v,{})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.f6b3e68b.chunk.js.map